\documentclass[a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{multirow}
\usepackage{parskip}
\usepackage{enumerate}
\usepackage{url}

% change to a new line when necessary
\makeatletter
\def\UrlAlphabet{%
      \do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j%
      \do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t%
      \do\u\do\v\do\w\do\x\do\y\do\z\do\A\do\B\do\C\do\D%
      \do\E\do\F\do\G\do\H\do\I\do\J\do\K\do\L\do\M\do\N%
      \do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V\do\W\do\X%
      \do\Y\do\Z}
\def\UrlDigits{\do\1\do\2\do\3\do\4\do\5\do\6\do\7\do\8\do\9\do\0}
\g@addto@macro{\UrlBreaks}{\UrlOrds}
\g@addto@macro{\UrlBreaks}{\UrlAlphabet}
\g@addto@macro{\UrlBreaks}{\UrlDigits}
\makeatother

% empty set package
\usepackage{amssymb}

\title{CSCE 440/840, Spring 2018, Homework 3}
\author{Tian Gao}
\begin{document}
\maketitle


% 2
2.\\
$$Q(x)=
\begin{cases}
Q_0(x)& 8 \leqslant x \leqslant 15\\
Q_1(x)& 15 \leqslant x \leqslant 22\\
Q_2(x)& 22 \leqslant x \leqslant 29\\
\end{cases}$$
$\because z_0=0$\\
$z_{i+1} = -z_i + 2(\frac{y_{i+1} - y_i}{t_{i+1} - t_i})$\\
$Q_i(x) = \frac{z_{i+1} - z_i}{2(t_{i+1} - t_i)}(x-t_i)^2 + z_i (x-t_i) + y_i$\\
$\therefore z_1 = 2, z_2 = -0.5714, z_3 = 1.1429$\\
$Q_0(x) = \frac{1}{7}x^2 - \frac{16}{7}x + \frac{274}{7}$\\
$Q_1(x) = -\frac{9}{49}x^2 + \frac{368}{49}x -\frac{1682}{49}$\\
$Q_2(x) = \frac{6}{49}x^2 -\frac{292}{49}x + \frac{5578}{49}$\\

% 3
3.\\
$$S(x)=
\begin{cases}
S_0(x)=a_0 + b_0(x-8) + c_0(x-8)^2 + d_0(x-8)^3& 8 \leqslant x \leqslant 15\\
S_1(x)=a_1 + b_1(x-15) + c_1(x-15)^2 + d_1(x-15)^3& 15 \leqslant x \leqslant 22\\
S_2(x)=a_2 + b_2(x-22) + c_2(x-22)^2 + d_2(x-22)^3& 22 \leqslant x \leqslant 29\\
\end{cases}$$
$[a_0, a_1, a_2, a_3] = [y_0, y_1, y_2, y_3] = [30, 37, 42, 44]$\\
$\because h_j = x_{j+1} - x_j$\\
$\therefore [h_0, h_1, h_2] = [7, 7, 7]$\\
$A =
\begin{bmatrix}
    1                       & 0                      & 0  & 0 \\
    7                       & 28                     & 7  & 0 \\
    0                       & 7                      & 28 & 7 \\
    0 & 0& 0  & 1 \\
\end{bmatrix}
x =
\begin{bmatrix}
    c_0                     \\
    c_1                     \\
    c_2                     \\
    c_3                     \\
\end{bmatrix}
b =
\begin{bmatrix}
    0                     \\
    \frac{3}{h_1}(a_2-a_1) - \frac{3}{h_0}(a_1-a_0)                     \\
    \frac{3}{h_2}(a_3-a_2) - \frac{3}{h_1}(a_2-a_1)                     \\
    0                     \\
\end{bmatrix}=\\
\begin{bmatrix}
    0                     \\
    -0.8571                     \\
    -1.2857                     \\
    0                     \\
\end{bmatrix}$\\
x can be solved by solving equation Ax=b.\\
$\therefore [c_0, c_1, c_2, c_3] = [0, -0.0204, -0.0408, 0]$\\
$\because b_i = \frac{1}{h_i}(a_{i+1}-a_i)-\frac{h_i}{3}(c_{i+1}+2c_i), d_i = \frac{1}{3h_i}(c_{i+1} - c_i)$\\
$\therefore [b_0, b_1, b_2] = [1.0476, 0.9048, 0.4762], [d_0, d_1, d_2] = [-0.0010, -0.0010, 0.0019]$\\
$\therefore S_0(x) = \frac{22}{21}x -\frac{7720456504063707}{162259276829213363391578010288128}(x - 8)^2 -\frac{1}{1029}(x - 8)^3 + \frac{454}{21}$\\
$S_1(x) = \frac{19}{21}x -\frac{1}{49}(x - 15)^2 -\frac{1}{1029}(x - 15)^3 +\frac{164}{7}$\\
$S_2(x) = \frac{10}{21}x -\frac{2}{49}(x - 22)^2 + \frac{2}{1029}(x - 22)^3 + \frac{662}{21}$\\
(note: $S_0(x)$ seems weird here, but it is true that $S_0(8)=30$ and $S_0(15)=37$ hold.)

% 4
4.\\
$$S(x)=
\begin{cases}
S_0(x)=a_0 + b_0(x-8) + c_0(x-8)^2 + d_0(x-8)^3& 8 \leqslant x \leqslant 15\\
S_1(x)=a_1 + b_1(x-15) + c_1(x-15)^2 + d_1(x-15)^3& 15 \leqslant x \leqslant 22\\
S_2(x)=a_2 + b_2(x-22) + c_2(x-22)^2 + d_2(x-22)^3& 22 \leqslant x \leqslant 29\\
\end{cases}$$
$[a_0, a_1, a_2, a_3] = [y_0, y_1, y_2, y_3] = [30, 37, 42, 44]$, $h=a_1 - a_0 = 7$\\
$A =
\begin{bmatrix}
    r                     & 1 & 0 & 0 \\
    1                     & 4 & 1 & 0 \\
    0                     & 1 & 4 & 1 \\
    0                     & 0 & 0 & 1 \\
\end{bmatrix}
x =
\begin{bmatrix}
    c_0                     \\
    c_1                     \\
    c_2                     \\
    c_3                     \\
\end{bmatrix}
b =
\begin{bmatrix}
    e_0                     \\
    e_1                 \\
    e_2                 \\
    e_3                     \\
\end{bmatrix} =
\begin{bmatrix}
    \frac{3r}{2h} \frac{a_1-a_0}{h}                     \\
    \frac{3}{h^2}(a_0 - 2a_1 + a_2)                     \\
    \frac{3}{h^2}(a_1 - 2a_2 + a_3)                     \\
    0                     \\
\end{bmatrix} =
\begin{bmatrix}
    0.7997                     \\
    -0.1224                     \\
    -0.1837                     \\
    0                     \\
\end{bmatrix}
$\\
r = $2 + \sqrt{3}$\\
Using recurrence equations, we can get
$ [\alpha_0, \alpha_1, \alpha_2, \alpha_3] = [0.2143, -0.0902, -0.0250, 0]$\\
$\therefore [c_0, c_1, c_2, c_3] = [0.2367, -0.0835, -0.0250, 0]$\\
$\because b_i = \frac{1}{h}(a_{i+1}-a_i)-\frac{h}{3}(c_{i+1}+2c_i), d_i = \frac{1}{3h}(c_{i+1} - c_i)$\\
$\therefore [b_0, b_1, b_2] = [0.0904, 1.1625, 0.4026], [d_0, d_1, d_2] = [-0.0152, 0.0028, 0.0012]$\\
$\therefore S_0(x) = -\frac{814635470252391}{9007199254740992}x + \frac{4263368258924685}{18014398509481984}(x - 8)^2 -\frac{274662249867257}{18014398509481984}(x - 8)^3 + \frac{32962361735026329}{1125899906842624}$\\
$S_1(x) = \frac{5235268958740899}{4503599627370496}x -\frac{6018155953150847}{72057594037927936}(x - 15)^2 + \frac{6421223418313749}{2305843009213693952}(x - 15)^3 -\frac{88104151831594867}{4503599627370496}$\\
$S_2(x) = -\frac{453243985525333}{1125899906842624}x + \frac{7216912339529795}{288230376151711744}(x - 22)^2 -\frac{5498599877736987}{4611686018427387904}(x - 22)^3 + \frac{18658214202916441}{562949953421312}$\\

% 5
5.\\
The code wrote in MATLAB can be found in run.m and spatialInt.m.\\
The code has been tested in MATLAB R2017a.\\
To run the programme, just put the scripts in the same folder and run run.m.\\
For Figure 1, the results are listed as follows: \\

The 3 vertices are: (0,20), (5,13), (5,13)\\
The linear interpolation function of the triangular surface is: 567*x + 105*y + 9450

The 3 vertices are: (0,20), (12,20), (12,20)\\
The linear interpolation function of the triangular surface is: (7*x)/2 - (595*y)/2 + 17500

The 3 vertices are: (12,20), (20,20), (20,20)\\
The linear interpolation function of the triangular surface is: 6*x - 78*y + 13080

The 3 vertices are: (5,13), (0,10), (0,10)\\
The linear interpolation function of the triangular surface is: 378*x + 420*y + 6300

The 3 vertices are: (12,20), (5,13), (5,13)\\
The linear interpolation function of the triangular surface is: 15400 - 35*y - 259*x

The 3 vertices are: (12,20), (16,12), (16,12)\\
The linear interpolation function of the triangular surface is: 14*x - 74*y + 12904

The 3 vertices are: (20,20), (16,12), (16,12)\\
The linear interpolation function of the triangular surface is: 54*x - 102*y + 12600

The 3 vertices are: (0,10), (3,6), (3,6)\\
The linear interpolation function of the triangular surface is: 390*x + 450*y + 6000

The 3 vertices are: (16,12), (10,6), (10,6)\\
The linear interpolation function of the triangular surface is: 45*x - 105*y + 12780

The 3 vertices are: (0,10), (3,6), (3,6)\\
The linear interpolation function of the triangular surface is: (117*y)/2 - 132*x + 9915

The 3 vertices are: (3,6), (0,0), (0,0)\\
The linear interpolation function of the triangular surface is: 600*x - (615*y)/2 + 9915

The 3 vertices are: (3,6), (10,6), (10,6)\\
The linear interpolation function of the triangular surface is: 390*x - (755*y)/2 + 10965

The 3 vertices are: (10,6), (5,0), (5,0)\\
The linear interpolation function of the triangular surface is: 51*x - 95*y + 12660

% 6
6.\\
The code wrote in MATLAB can be found in visualization.m.\\
The code has been tested in MATLAB R2017a.\\
The script can be directly ran.\\
For Figure 1, the result is: \\
\includegraphics[height=150px]{1.png}

\end{document}
